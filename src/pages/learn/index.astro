---
export const prerender = true;

import PageLayout from '../../layouts/PageLayout.astro';
import { getCollection } from 'astro:content';
import { SITE, COURSE } from '../../lib/constants';

const allLessons = await getCollection('course', ({ data }) => !data.draft);
const publishedCount = allLessons.length;
const publishedModules = [...new Set(allLessons.map((l) => l.data.module))].length;

const courses = [
  {
    ...COURSE,
    publishedLessons: publishedCount,
    publishedModules,
    href: `/learn/${COURSE.slug}`,
    badge: 'Free',
    level: 'Beginner',
    duration: '~2h',
    status: 'active' as const,
  },
];
---

<PageLayout
  title={`Learn — Free iOS Development Courses — ${SITE.name}`}
  description="Free courses to learn iOS development with AI. Build real native apps using Swift, SwiftUI, and Claude Code."
>
  <!-- Hero -->
  <section class="relative py-20 sm:py-28 overflow-hidden bg-white dark:bg-slate-950">
    <div class="absolute inset-0 hero-gradient opacity-50"></div>
    <div class="relative max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 text-sm font-medium mb-6">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
        </svg>
        NativeFirst Academy
      </div>

      <h1 class="font-display font-extrabold text-4xl sm:text-5xl md:text-6xl text-slate-900 dark:text-white mb-6 leading-tight">
        <span class="gradient-text">Learn to Build</span>
        <br />
        <span class="text-3xl sm:text-4xl md:text-5xl">Native iOS Apps with AI</span>
      </h1>

      <p class="text-lg sm:text-xl text-slate-600 dark:text-slate-400 max-w-2xl mx-auto">
        Free, hands-on courses that teach you how to build production-quality iOS apps using AI-powered development workflows.
      </p>
    </div>
  </section>

  <!-- Courses Grid -->
  <section class="py-16 sm:py-20 bg-white dark:bg-slate-950">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="font-display font-bold text-2xl sm:text-3xl text-slate-900 dark:text-white mb-10 text-center">
        Our Courses
      </h2>

      <div class="grid gap-8 sm:grid-cols-1 lg:grid-cols-2">
        {courses.map((course) => (
          <a
            href={course.href}
            class="group relative flex flex-col rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 overflow-hidden hover:border-purple-300 dark:hover:border-purple-700 hover:shadow-xl hover:shadow-purple-500/5 transition-all"
          >
            {/* Gradient top bar */}
            <div class="h-2 gradient-brand" />

            <div class="flex-1 p-6 sm:p-8">
              {/* Badges */}
              <div class="flex items-center gap-2 mb-4">
                {course.badge && (
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold gradient-brand text-white">
                    {course.badge}
                  </span>
                )}
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400">
                  {course.level}
                </span>
                {course.status === 'active' && (
                  <span class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400">
                    <span class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse" />
                    Active
                  </span>
                )}
              </div>

              {/* Title & subtitle */}
              <h3 class="font-display font-bold text-2xl text-slate-900 dark:text-white mb-1 group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors">
                {course.title}
              </h3>
              <p class="text-sm font-medium text-purple-600 dark:text-purple-400 mb-3">
                {course.subtitle}
              </p>

              {/* Description */}
              <p class="text-slate-600 dark:text-slate-400 text-sm leading-relaxed mb-6">
                {course.description}
              </p>

              {/* Stats */}
              <div class="flex items-center gap-4 text-sm text-slate-500 dark:text-slate-400">
                <div class="flex items-center gap-1.5">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                  </svg>
                  {course.publishedLessons} lessons
                </div>
                <div class="flex items-center gap-1.5">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                  </svg>
                  {course.publishedModules} modules
                </div>
                <div class="flex items-center gap-1.5">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                  {course.duration}
                </div>
              </div>
            </div>

            {/* Footer */}
            <div class="px-6 sm:px-8 py-4 border-t border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-800/20 flex items-center justify-between">
              <span class="text-sm font-medium text-purple-600 dark:text-purple-400 group-hover:gap-2 transition-all inline-flex items-center gap-1.5">
                View Course
                <svg class="w-4 h-4 group-hover:translate-x-0.5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                </svg>
              </span>
              <span class="text-xs text-slate-400 dark:text-slate-500">
                by {course.author}
              </span>
            </div>
          </a>
        ))}

        {/* Coming soon placeholder */}
        <div class="flex flex-col items-center justify-center rounded-2xl border border-dashed border-slate-300 dark:border-slate-700 p-8 sm:p-12 text-center min-h-[300px]">
          <div class="w-14 h-14 rounded-2xl bg-slate-100 dark:bg-slate-800 flex items-center justify-center mb-4">
            <svg class="w-7 h-7 text-slate-400 dark:text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
            </svg>
          </div>
          <p class="font-display font-semibold text-lg text-slate-500 dark:text-slate-400 mb-1">
            More Courses Coming Soon
          </p>
          <p class="text-sm text-slate-400 dark:text-slate-500 max-w-xs">
            We're working on new courses covering advanced SwiftUI, app architecture, and more.
          </p>
        </div>
      </div>
    </div>
  </section>
</PageLayout>
